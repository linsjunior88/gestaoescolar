<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EMEF Nazaré Rodrigues - Painel do Professor</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- FullCalendar -->
    <link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/main.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/locales/pt-br.js"></script>
    <!-- CSS do Calendário -->
    <link rel="stylesheet" href="css/calendario.css">
    <!-- CSS Personalizado - Mobile First -->
    <link rel="stylesheet" href="css/professor-mobile.css">
    <!-- Garantir que o Bootstrap JS seja carregado no head para resolver problemas com dropdowns -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Estilos Personalizados -->
    <link href="css/dashboard.css" rel="stylesheet">
</head>
<body>
    <!-- Navbar Principal -->
    <nav class="navbar navbar-expand-lg navbar-light sticky-top">
        <div class="container-fluid">
            <!-- Logo e Nome da Escola -->
            <a class="navbar-brand d-flex align-items-center" href="#">
                <img src="img/logo.png" alt="Logo Nazaré Rodrigues" class="me-2" style="max-height: 40px;">
                <span class="h5 mb-0 d-none d-sm-inline">EMEF Nazaré Rodrigues</span>
            </a>
            
            <!-- Botão de Toggle do Menu -->
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            
            <!-- Menu de Navegação -->
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item">
                        <a id="dashboard-link" class="nav-link active" href="#">
                            <i class="fas fa-home"></i> Dashboard
                        </a>
                    </li>
                    <li class="nav-item">
                        <a id="alunos-link" class="nav-link" href="#">
                            <i class="fas fa-user-graduate"></i> Alunos
                        </a>
                    </li>
                    <li class="nav-item">
                        <a id="notas-link" class="nav-link" href="#">
                            <i class="fas fa-graduation-cap"></i> Gestão de Notas
                        </a>
                    </li>
                </ul>
                
                <!-- Perfil do Usuário -->
                <ul class="navbar-nav">
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            <span class="d-none d-md-inline me-2">Olá, <span id="professor-nome">Professor</span></span>
                            <i class="fas fa-user-circle"></i>
                        </a>
                        <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="navbarDropdown">
                            <li>
                                <a class="dropdown-item" href="#" id="perfil-professor-link">
                                    <i class="fas fa-id-card"></i> Meu Perfil
                                </a>
                            </li>
                            <li><hr class="dropdown-divider"></li>
                            <li>
                                <a class="dropdown-item" href="index.html" id="btn-logout">
                                    <i class="fas fa-sign-out-alt"></i> Sair
                                </a>
                            </li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    
    <!-- Conteúdo Principal -->
    <main class="main-content">
        <!-- Cabeçalho da Página -->
        <div class="container-fluid">
            <div class="row mb-4">
                <div class="col-12">
                    <h1 id="page-title" class="h3 page-title">Dashboard</h1>
                    <p id="page-subtitle" class="page-subtitle">Área restrita do professor</p>
                </div>
            </div>
            
            <!-- Conteúdo do Dashboard -->
            <div id="conteudo-dashboard" class="conteudo-secao active">
                <div class="row g-3">
                    <!-- Cards Totalizadores -->
                    <div class="col-6 col-md-3">
                        <div class="card border-left-primary shadow h-100 py-2">
                            <div class="card-body">
                                <div class="row no-gutters align-items-center">
                                    <div class="col mr-2">
                                        <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">
                                            Turmas
                                        </div>
                                        <div class="h5 mb-0 font-weight-bold text-gray-800" id="total-turmas">0</div>
                                    </div>
                                    <div class="col-auto">
                                        <i class="fas fa-chalkboard fa-2x text-gray-300"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Total de Disciplinas -->
                    <div class="col-6 col-md-3">
                        <div class="card border-left-success shadow h-100 py-2">
                            <div class="card-body">
                                <div class="row no-gutters align-items-center">
                                    <div class="col mr-2">
                                        <div class="text-xs font-weight-bold text-success text-uppercase mb-1">
                                            Disciplinas
                                        </div>
                                        <div class="h5 mb-0 font-weight-bold text-gray-800" id="total-disciplinas">0</div>
                                    </div>
                                    <div class="col-auto">
                                        <i class="fas fa-book fa-2x text-gray-300"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Total de Alunos -->
                    <div class="col-6 col-md-3">
                        <div class="card border-left-info shadow h-100 py-2">
                            <div class="card-body">
                                <div class="row no-gutters align-items-center">
                                    <div class="col mr-2">
                                        <div class="text-xs font-weight-bold text-info text-uppercase mb-1">
                                            Alunos
                                        </div>
                                        <div class="h5 mb-0 font-weight-bold text-gray-800" id="total-alunos">0</div>
                                    </div>
                                    <div class="col-auto">
                                        <i class="fas fa-user-graduate fa-2x text-gray-300"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Total de Notas Lançadas -->
                    <div class="col-6 col-md-3">
                        <div class="card border-left-warning shadow h-100 py-2">
                            <div class="card-body">
                                <div class="row no-gutters align-items-center">
                                    <div class="col mr-2">
                                        <div class="text-xs font-weight-bold text-warning text-uppercase mb-1">
                                            Notas
                                        </div>
                                        <div class="h5 mb-0 font-weight-bold text-gray-800" id="total-notas">0</div>
                                    </div>
                                    <div class="col-auto">
                                        <i class="fas fa-graduation-cap fa-2x text-gray-300"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Calendário Acadêmico -->
                <div class="row mt-4">
                    <div class="col-md-8">
                        <div class="card shadow mb-4">
                            <div class="card-header py-3 d-flex justify-content-between align-items-center">
                                <h6 class="m-0 font-weight-bold text-primary">
                                    <i class="fas fa-calendar-alt me-2"></i>Calendário Acadêmico
                                </h6>
                            </div>
                            <div class="card-body p-2">
                                <div id="calendario-escolar-professor"></div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card shadow mb-4">
                            <div class="card-header py-3">
                                <h6 class="m-0 font-weight-bold text-primary">Estatísticas do Mês</h6>
                            </div>
                            <div class="card-body">
                                <div class="stat-item mb-3">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <span class="text-muted">Total de Eventos</span>
                                        <span class="badge bg-primary" id="total-eventos-mes-professor">0</span>
                                    </div>
                                </div>
                                <div class="stat-item mb-3">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <span class="text-muted">Feriados</span>
                                        <span class="badge bg-danger" id="total-feriados-mes-professor">0</span>
                                    </div>
                                </div>
                                <div class="stat-item mb-3">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <span class="text-muted">Eventos Escolares</span>
                                        <span class="badge bg-success" id="total-eventos-escolares-mes-professor">0</span>
                                    </div>
                                </div>
                                <div class="stat-item mb-3">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <span class="text-muted">Reuniões</span>
                                        <span class="badge bg-warning" id="total-reunioes-mes-professor">0</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Próximos Eventos -->
                        <div class="card shadow">
                            <div class="card-header py-3">
                                <h6 class="m-0 font-weight-bold text-primary">Próximos Eventos</h6>
                            </div>
                            <div class="card-body">
                                <div id="lista-proximos-eventos-professor">
                                    <!-- Será preenchido via JavaScript -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="row mt-4">
                    <!-- Minhas Turmas e Disciplinas -->
                    <div class="col-md-8 mb-4">
                        <div class="card shadow h-100">
                            <div class="card-header py-3 d-flex justify-content-between align-items-center">
                                <h6 class="m-0 font-weight-bold text-primary">Minhas Turmas e Disciplinas</h6>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-bordered">
                                        <thead class="table-light">
                                            <tr>
                                                <th>Disciplina</th>
                                                <th>Turmas</th>
                                                <th>Alunos</th>
                                            </tr>
                                        </thead>
                                        <tbody id="professor-disciplinas-lista">
                                            <!-- Disciplinas e turmas do professor serão exibidas aqui -->
                                            <tr class="text-center">
                                                <td colspan="3">Carregando...</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Meu Perfil -->
                    <div class="col-md-4 mb-4">
                        <div class="card shadow h-100">
                            <div class="card-header py-3">
                                <h6 class="m-0 font-weight-bold text-primary">Meu Perfil</h6>
                            </div>
                            <div class="card-body">
                                <div class="text-center mb-4">
                                    <i class="fas fa-user-circle fa-5x text-primary"></i>
                                </div>
                                <ul class="list-group list-group-flush">
                                    <li class="list-group-item d-flex justify-content-between align-items-center">
                                        <strong>ID:</strong>
                                        <span id="perfil-id">-</span>
                                    </li>
                                    <li class="list-group-item d-flex justify-content-between align-items-center">
                                        <strong>Nome:</strong>
                                        <span id="perfil-nome">-</span>
                                    </li>
                                    <li class="list-group-item d-flex justify-content-between align-items-center">
                                        <strong>Email:</strong>
                                        <span id="perfil-email">-</span>
                                    </li>
                                    <li class="list-group-item d-flex justify-content-between align-items-center">
                                        <strong>Disciplinas:</strong>
                                        <span id="perfil-disciplinas">-</span>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Atividades Recentes -->
                <div class="row">
                    <div class="col-12">
                        <div class="card shadow mb-4">
                            <div class="card-header py-3">
                                <h6 class="m-0 font-weight-bold text-primary">Atividades Recentes</h6>
                            </div>
                            <div class="card-body">
                                <div class="timeline" id="logs-atividades">
                                    <p class="text-center text-muted">Carregando atividades recentes...</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Conteúdo de Alunos -->
            <div id="conteudo-alunos" class="conteudo-secao">
                <h2 class="h3 mb-4">Meus Alunos</h2>
                
                <!-- Filtros -->
                <div class="card shadow mb-4">
                    <div class="card-header py-3 d-flex justify-content-between align-items-center">
                        <h6 class="m-0 font-weight-bold text-primary">Filtrar Alunos</h6>
                        <button class="btn btn-sm btn-outline-secondary d-md-none" type="button" data-bs-toggle="collapse" data-bs-target="#filtrosAlunos">
                            <i class="fas fa-filter"></i>
                        </button>
                    </div>
                    <div class="card-body collapse show" id="filtrosAlunos">
                        <form id="form-filtro-alunos-professor">
                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <label for="filtro-turma-professor" class="form-label">Turma</label>
                                    <select class="form-select" id="filtro-turma-professor">
                                        <option value="">Todas as turmas</option>
                                    </select>
                                </div>
                                <div class="col-md-6">
                                    <label for="filtro-disciplina-professor" class="form-label">Disciplina</label>
                                    <select class="form-select" id="filtro-disciplina-professor">
                                        <option value="">Todas as disciplinas</option>
                                    </select>
                                </div>
                            </div>
                            <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                                <button type="button" class="btn btn-primary" id="btn-filtrar-alunos-professor">
                                    <i class="fas fa-filter"></i> Filtrar
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
                
                <!-- Tabela de Alunos -->
                <div class="card shadow mb-4">
                    <div class="card-header py-3 d-flex justify-content-between align-items-center">
                        <h6 class="m-0 font-weight-bold text-primary">Alunos</h6>
                        <div>
                            <button type="button" class="btn btn-sm btn-outline-primary" id="btn-exportar-alunos-professor">
                                <i class="fas fa-file-export"></i> <span class="d-none d-md-inline">Exportar</span>
                            </button>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-bordered">
                                <thead class="table-light">
                                    <tr>
                                        <th>ID</th>
                                        <th>Nome</th>
                                        <th>Turma</th>
                                        <th>Ações</th>
                                    </tr>
                                </thead>
                                <tbody id="tabela-alunos-professor">
                                    <!-- Dados dos alunos serão carregados aqui -->
                                    <tr class="text-center">
                                        <td colspan="4">Carregando...</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Conteúdo de Gestão de Notas -->
            <div id="conteudo-notas" class="conteudo-secao">
                <h2 class="h3 mb-4">Gestão de Notas</h2>
                
                <!-- Card para filtros -->
                <div class="card shadow mb-4">
                    <div class="card-header py-3 d-flex justify-content-between align-items-center">
                        <h6 class="m-0 font-weight-bold text-primary">Filtros</h6>
                        <div class="d-flex">
                            <button class="btn btn-primary btn-sm me-2" id="btn-novo-lancamento">
                                <i class="fas fa-plus"></i> <span class="d-none d-md-inline">Novo Lançamento</span>
                            </button>
                            <button class="btn btn-success btn-sm me-2" id="btn-lancamento-massa">
                                <i class="fas fa-list-ol"></i> <span class="d-none d-md-inline">Lançamento em Massa</span>
                            </button>
                            <button type="button" class="btn btn-sm btn-outline-success" id="btn-gerar-pdf-notas">
                                <i class="fas fa-file-pdf"></i> <span class="d-none d-md-inline">Gerar PDF</span>
                            </button>
                        </div>
                        <button class="btn btn-sm btn-outline-secondary d-md-none" type="button" data-bs-toggle="collapse" data-bs-target="#filtrosNotas">
                            <i class="fas fa-filter"></i>
                        </button>
                    </div>
                    <div class="card-body collapse show" id="filtrosNotas">
                        <form id="form-filtro-notas-professor">
                            <div class="row mb-3">
                                <div class="col-md-4">
                                    <label for="filtro-turma-notas" class="form-label">Turma</label>
                                    <select class="form-select" id="filtro-turma-notas">
                                        <option value="">Todas as turmas</option>
                                    </select>
                                </div>
                                <div class="col-md-4">
                                    <label for="filtro-disciplina-notas" class="form-label">Disciplina</label>
                                    <select class="form-select" id="filtro-disciplina-notas">
                                        <option value="">Todas as disciplinas</option>
                                    </select>
                                </div>
                                <div class="col-md-4">
                                    <label for="filtro-bimestre-notas" class="form-label">Bimestre</label>
                                    <select class="form-select" id="filtro-bimestre-notas">
                                        <option value="">Todos os bimestres</option>
                                        <option value="1">1º Bimestre</option>
                                        <option value="2">2º Bimestre</option>
                                        <option value="3">3º Bimestre</option>
                                        <option value="4">4º Bimestre</option>
                                    </select>
                                </div>
                            </div>
                            <div class="row mb-3">
                                <div class="col-md-4">
                                    <label for="filtro-aluno-notas" class="form-label">Aluno</label>
                                    <select class="form-select" id="filtro-aluno-notas">
                                        <option value="">Todos os alunos</option>
                                    </select>
                                </div>
                                <div class="col-md-4">
                                    <label for="filtro-ano-notas" class="form-label">Ano</label>
                                    <select class="form-select" id="filtro-ano-notas">
                                        <option value="">Todos os anos</option>
                                    </select>
                                </div>
                            </div>
                            <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                                <button type="button" class="btn btn-primary" id="btn-filtrar-notas">
                                    <i class="fas fa-filter"></i> Filtrar
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
                
                <!-- Card para cadastro/edição de notas -->
                <div class="card shadow mb-4 d-none" id="card-lancamento-nota">
                    <div class="card-header py-3 d-flex justify-content-between align-items-center">
                        <h6 class="m-0 font-weight-bold text-primary" id="form-nota-titulo">Lançamento de Notas</h6>
                        <button class="btn btn-outline-secondary btn-sm" id="btn-cancelar-nota">
                            <i class="fas fa-times"></i> Cancelar
                        </button>
                    </div>
                    <div class="card-body">
                        <form id="form-nota">
                            <input type="hidden" id="form-modo-nota" value="novo">
                            <input type="hidden" id="nota-index" value="">
                            
                            <div class="row mb-3">
                                <div class="col-md-4">
                                    <label for="ano_nota" class="form-label">Ano</label>
                                    <select class="form-select" id="ano_nota" required>
                                        <option value="">Selecione...</option>
                                    </select>
                                </div>
                                <div class="col-md-4">
                                    <label for="bimestre" class="form-label">Bimestre</label>
                                    <select class="form-select" id="bimestre" required>
                                        <option value="">Selecione...</option>
                                    </select>
                                </div>
                                <div class="col-md-4">
                                    <label for="turma_nota" class="form-label">Turma</label>
                                    <select class="form-select" id="turma_nota" required>
                                        <option value="">Selecione...</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <label for="disciplina_nota" class="form-label">Disciplina</label>
                                    <select class="form-select" id="disciplina_nota" required>
                                        <option value="">Selecione...</option>
                                    </select>
                                </div>
                                <div class="col-md-6">
                                    <label for="aluno_nota" class="form-label">Aluno</label>
                                    <select class="form-select" id="aluno_nota" required>
                                        <option value="">Selecione...</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="row mb-3">
                                <div class="col-md-4">
                                    <label for="nota_mensal" class="form-label">Nota Mensal</label>
                                    <input type="number" class="form-control" id="nota_mensal" min="0" max="10" step="0.1" placeholder="0.0 a 10.0">
                                </div>
                                <div class="col-md-4">
                                    <label for="nota_bimestral" class="form-label">Nota Bimestral</label>
                                    <input type="number" class="form-control" id="nota_bimestral" min="0" max="10" step="0.1" placeholder="0.0 a 10.0">
                                </div>
                                <div class="col-md-4">
                                    <label for="recuperacao" class="form-label">Recuperação</label>
                                    <input type="number" class="form-control" id="recuperacao" min="0" max="10" step="0.1" placeholder="0.0 a 10.0">
                                </div>
                            </div>
                            
                            <div class="row mb-3">
                                <div class="col-md-4">
                                    <label for="media" class="form-label">Média Final</label>
                                    <input type="number" class="form-control" id="media" min="0" max="10" step="0.1" readonly placeholder="Calculada automaticamente">
                                </div>
                            </div>
                            
                            <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                                <button type="submit" class="btn btn-primary" id="btn-salvar-nota">
                                    <i class="fas fa-save"></i> Salvar Notas
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            
            <!-- Rodapé -->
            <footer class="mt-5 mb-5 pb-4">
                <div class="text-center">
                    <p class="text-muted">&copy; 2024 EMEF Nazaré Rodrigues</p>
                </div>
            </footer>
        </div>
    </main>
    
    <!-- Navegação Inferior Mobile -->
    <div class="bottom-nav d-md-none">
        <a href="#" class="bottom-nav-item active" id="bottom-dashboard-link">
            <i class="fas fa-home bottom-nav-icon"></i>
            <span class="bottom-nav-text">Dashboard</span>
        </a>
        <a href="#" class="bottom-nav-item" id="bottom-alunos-link">
            <i class="fas fa-user-graduate bottom-nav-icon"></i>
            <span class="bottom-nav-text">Alunos</span>
        </a>
        <a href="#" class="bottom-nav-item" id="bottom-notas-link">
            <i class="fas fa-graduation-cap bottom-nav-icon"></i>
            <span class="bottom-nav-text">Notas</span>
        </a>
        <a href="#" class="bottom-nav-item" id="bottom-perfil-link">
            <i class="fas fa-user-circle bottom-nav-icon"></i>
            <span class="bottom-nav-text">Perfil</span>
        </a>
    </div>
    
    <!-- Botão Voltar ao Topo -->
    <a href="#" class="back-to-top" id="backToTop">
        <i class="fas fa-arrow-up"></i>
    </a>
    
    <!-- Bibliotecas PDF -->
    <!-- jsPDF Biblioteca para geração de PDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.29/jspdf.plugin.autotable.min.js"></script>
    <script>
        // Verificar se as bibliotecas jsPDF e AutoTable foram carregadas corretamente
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Verificando disponibilidade das bibliotecas jsPDF:');
            console.log('- jspdf disponível:', typeof window.jspdf !== 'undefined');
            console.log('- jsPDF disponível:', typeof window.jsPDF !== 'undefined');
            
            // Verificar o objeto jsPDF
            if (typeof window.jspdf !== 'undefined') {
                console.log('- window.jspdf.jsPDF disponível:', typeof window.jspdf.jsPDF === 'function');
            }
            
            // Verificar o plugin AutoTable
            try {
                let jsPDFConstructor;
                if (typeof window.jspdf !== 'undefined' && typeof window.jspdf.jsPDF === 'function') {
                    jsPDFConstructor = window.jspdf.jsPDF;
                } else if (typeof window.jsPDF === 'function') {
                    jsPDFConstructor = window.jsPDF;
                }
                
                if (jsPDFConstructor) {
                    const testDoc = new jsPDFConstructor();
                    console.log('- autoTable disponível:', typeof testDoc.autoTable === 'function');
                }
            } catch (e) {
                console.error('Erro ao verificar AutoTable:', e);
            }
        });
    </script>
    
    <!-- Scripts -->
    <script src="js/config.js"></script>
    <script src="js/calendario-professor.js"></script>
    <script src="js/notas-inicializacao.js"></script>
    <script src="js/professor-dashboard-novo.js?v=5"></script>
    <script src="js/salvar-lancamento.js"></script>
    <script src="js/gerador-pdf.js"></script>
    
    <!-- Script adicional para elementos da nova interface mobile -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Controle do botão voltar ao topo
            const backToTopButton = document.getElementById('backToTop');
            
            window.addEventListener('scroll', function() {
                if (window.pageYOffset > 300) {
                    backToTopButton.classList.add('show');
                } else {
                    backToTopButton.classList.remove('show');
                }
            });
            
            backToTopButton.addEventListener('click', function(e) {
                e.preventDefault();
                window.scrollTo({top: 0, behavior: 'smooth'});
            });
            
            // Navegação inferior mobile
            const bottomNavItems = document.querySelectorAll('.bottom-nav-item');
            const navLinks = {
                'bottom-dashboard-link': 'dashboard-link',
                'bottom-alunos-link': 'alunos-link',
                'bottom-notas-link': 'notas-link',
                'bottom-perfil-link': 'perfil-professor-link'
            };
            
            bottomNavItems.forEach(item => {
                item.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    // Remover classe ativa de todos os itens
                    bottomNavItems.forEach(navItem => navItem.classList.remove('active'));
                    
                    // Adicionar classe ativa ao item clicado
                    this.classList.add('active');
                    
                    // Simular clique no link correspondente no navbar
                    const correspondingLink = navLinks[this.id];
                    if (correspondingLink) {
                        document.getElementById(correspondingLink).click();
                    }
                    
                    // Fechar o menu hamburger se estiver aberto
                    const navbarCollapse = document.getElementById('navbarNav');
                    if (navbarCollapse.classList.contains('show')) {
                        document.querySelector('.navbar-toggler').click();
                    }
                });
            });
            
            // Sincronizar estado ativo entre navbar e bottom-nav
            const mainNavLinks = document.querySelectorAll('#navbarNav .nav-link');
            
            mainNavLinks.forEach(link => {
                link.addEventListener('click', function() {
                    // Atualizar bottom-nav ativo
                    for (const [bottomId, mainId] of Object.entries(navLinks)) {
                        if (mainId === this.id) {
                            document.querySelectorAll('.bottom-nav-item').forEach(item => {
                                item.classList.remove('active');
                            });
                            document.getElementById(bottomId).classList.add('active');
                            break;
                        }
                    }
                });
            });
            
            // Adaptações para colapsar filtros em mobile
            const filtrosToggles = document.querySelectorAll('[data-bs-toggle="collapse"]');
            filtrosToggles.forEach(toggle => {
                toggle.addEventListener('click', function() {
                    const icon = this.querySelector('i');
                    if (icon) {
                        if (icon.classList.contains('fa-filter')) {
                            icon.classList.remove('fa-filter');
                            icon.classList.add('fa-times');
                        } else {
                            icon.classList.remove('fa-times');
                            icon.classList.add('fa-filter');
                        }
                    }
                });
            });
            
            // Função de logout para garantir funcionamento
            function fazerLogout() {
                console.log("Logout acionado");
                sessionStorage.clear();
                window.location.href = 'index.html';
            }
            
            // Configurar evento de logout para todos os botões
            const logoutButtons = [
                document.getElementById('btn-logout')
            ];
            
            logoutButtons.forEach(button => {
                if (button) {
                    button.addEventListener('click', function(e) {
                        e.preventDefault();
                        fazerLogout();
                    });
                }
            });
        });
    </script>
</body>
</html> 